import{a as E}from"./index-B9ygI19o.js";import{f as C,g as k,h as L,c as M,b as y,a as l,w as a,r as s,t as x,F as O,E as f,o as S,d as i,n as F}from"./index-DRXSRtcv.js";E.defaults.baseURL="";const U=[1,2,3,4,5].map(d=>({id:d,title:"法国的首都是什么？",options:"巴黎,伦敦,柏林",answer:"巴黎"})),J=d=>Promise.resolve({data:{code:0,data:{records:U,total:U.length}}}),T=d=>Promise.resolve({data:{code:0,msg:"ok"}}),q=d=>Promise.resolve({data:{code:0,msg:"ok"}}),z=d=>Promise.resolve({data:{code:0,msg:"ok"}}),I={style:{background:"#eef",padding:"10px","margin-bottom":"10px","border-radius":"4px"}},A={__name:"Question",setup(d){const u=C({keyword:"",page:1,size:10}),v=k([]),_=k(0),p=k(!1),t=C({id:0,title:"",options:"",answer:""}),m=async()=>{console.log("=== 开始获取列表 ===");try{const o=await J(u);console.log("接口返回:",o),v.value=o.data.data.records||[],_.value=o.data.data.total||0,console.log("设置后的list:",v.value),console.log("设置后的total:",_.value)}catch(o){console.error("获取列表失败:",o),f.error("获取列表失败")}},V=o=>{console.log("打开弹窗，行数据:",o),o?(t.id=o.id,t.title=o.title||"",t.options=o.options||"",t.answer=o.answer||""):(t.id=0,t.title="",t.options="",t.answer=""),p.value=!0},P=async()=>{console.log("=== 开始保存 ==="),console.log("表单数据:",JSON.parse(JSON.stringify(t)));try{let o;t.id?(o=await q(t),console.log("更新结果:",o)):(o=await T(t),console.log("添加结果:",o)),f.success("保存成功"),p.value=!1,console.log("保存成功，重新获取列表..."),await m(),await F(),console.log("DOM更新完成")}catch(o){console.error("保存失败:",o),f.error(o?.msg||"保存失败")}},N=async o=>{console.log("=== 开始删除 ==="),console.log("要删除的行数据:",o),console.log("要删除的ID:",o.id,"类型:",typeof o.id);try{console.log("调用删除接口...");const e=await z(o.id);console.log("删除接口返回结果:",e),f.success("删除成功"),console.log("删除成功，重新获取列表..."),await m(),console.log("列表重新获取完成")}catch(e){console.error("删除失败:",e),f.error(e?.msg||"删除失败")}};return L(()=>{console.log("=== 组件挂载 ==="),m()}),(o,e)=>{const b=s("el-input"),c=s("el-form-item"),r=s("el-button"),w=s("el-form"),g=s("el-table-column"),Q=s("el-table"),$=s("el-pagination"),B=s("el-dialog");return S(),M(O,null,[y("div",null,[l(w,{inline:""},{default:a(()=>[l(c,{label:"题目"},{default:a(()=>[l(b,{modelValue:u.keyword,"onUpdate:modelValue":e[0]||(e[0]=n=>u.keyword=n),placeholder:"关键词"},null,8,["modelValue"])]),_:1}),l(c,null,{default:a(()=>[l(r,{type:"primary",onClick:m},{default:a(()=>[...e[8]||(e[8]=[i("查询",-1)])]),_:1}),l(r,{onClick:e[1]||(e[1]=n=>V())},{default:a(()=>[...e[9]||(e[9]=[i("添加",-1)])]),_:1})]),_:1})]),_:1}),y("div",I,[y("div",null,"列表长度: "+x(v.value.length)+", 总数: "+x(_.value),1)]),l(Q,{data:v.value,border:""},{default:a(()=>[l(g,{prop:"id",label:"序号",width:"80"}),l(g,{prop:"title",label:"问题"}),l(g,{prop:"options",label:"选项"}),l(g,{prop:"answer",label:"答案"}),l(g,{label:"操作",width:"180"},{default:a(({row:n})=>[l(r,{link:"",onClick:D=>V(n)},{default:a(()=>[...e[10]||(e[10]=[i("编辑",-1)])]),_:1},8,["onClick"]),l(r,{link:"",type:"danger",onClick:D=>N(n)},{default:a(()=>[...e[11]||(e[11]=[i("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),l($,{class:"mt-4",background:"",layout:"prev, pager, next",total:_.value,"current-page":u.page,"onUpdate:currentPage":e[2]||(e[2]=n=>u.page=n),onCurrentChange:m},null,8,["total","current-page"])]),l(B,{modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=n=>p.value=n),title:t.id?"编辑":"添加",width:"500"},{footer:a(()=>[l(r,{onClick:e[6]||(e[6]=n=>p.value=!1)},{default:a(()=>[...e[12]||(e[12]=[i("取消",-1)])]),_:1}),l(r,{type:"primary",onClick:P},{default:a(()=>[...e[13]||(e[13]=[i("确定",-1)])]),_:1})]),default:a(()=>[l(w,{model:t,"label-width":"70"},{default:a(()=>[l(c,{label:"问题"},{default:a(()=>[l(b,{modelValue:t.title,"onUpdate:modelValue":e[3]||(e[3]=n=>t.title=n)},null,8,["modelValue"])]),_:1}),l(c,{label:"选项"},{default:a(()=>[l(b,{modelValue:t.options,"onUpdate:modelValue":e[4]||(e[4]=n=>t.options=n),placeholder:"逗号分隔"},null,8,["modelValue"])]),_:1}),l(c,{label:"答案"},{default:a(()=>[l(b,{modelValue:t.answer,"onUpdate:modelValue":e[5]||(e[5]=n=>t.answer=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}};export{A as default};
